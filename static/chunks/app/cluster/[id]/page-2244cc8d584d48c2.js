(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[707],{1168:(e,t,a)=>{"use strict";a.d(t,{K:()=>x});var s=a(5155),r=a(2115),i=a(5584),l=a(3999);function n(e){let{className:t,defaultValue:a,value:n,min:o=0,max:c=100,...d}=e,u=r.useMemo(()=>Array.isArray(n)?n:Array.isArray(a)?a:[o,c],[n,a,o,c]);return(0,s.jsxs)(i.bL,{"data-slot":"slider",defaultValue:a,value:n,min:o,max:c,className:(0,l.cn)("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",t),...d,children:[(0,s.jsx)(i.CC,{"data-slot":"slider-track",className:(0,l.cn)("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:(0,s.jsx)(i.Q6,{"data-slot":"slider-range",className:(0,l.cn)("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:u.length},(e,t)=>(0,s.jsx)(i.zi,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},t))]})}var o=a(7168),c=a(9074),d=a(6262),u=a(4481),m=a(8145);function x(e){let{onDateRangeChange:t,startYear:a,endYear:i,activeStartYear:l,activeEndYear:x,clusters:h}=e,[f,p]=(0,r.useState)(1),v=h||[],b=(()=>{let e={};return(v||[]).forEach(t=>{var a;if(!(null===(a=t.firstImageMeta)||void 0===a?void 0:a.pub_date))return;let s=new Date(t.firstImageMeta.pub_date).getFullYear();isNaN(s)||(e[s]=(e[s]||0)+t.imagePaths.length)}),e})(),g=Math.max(...Object.values(b)),j=(()=>{let e=f>=2?10:f>=1.5?25:50,t=[];for(let a=1700;a<=2024;a+=e)t.push(a);return t})(),N=e=>(e-1700)/324*100,y=e=>e/g*40;return(0,s.jsxs)("div",{className:"mb-10",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"Timeline"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(c.A,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)(m.E,{variant:"secondary",className:"text-sm",children:["From ",a," to ",i]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(o.$,{variant:"outline",size:"icon",onClick:()=>{f>.5&&p(f-.5)},children:(0,s.jsx)(d.A,{className:"h-4 w-4"})}),(0,s.jsx)(o.$,{variant:"outline",size:"icon",onClick:()=>{f<3&&p(f+.5)},children:(0,s.jsx)(u.A,{className:"h-4 w-4"})})]})]}),(0,s.jsxs)("div",{className:"relative border rounded-lg p-6 bg-background",children:[(0,s.jsx)("div",{className:"flex justify-between mb-4 text-xs text-muted-foreground",style:{width:"".concat(100*f,"%")},children:j.map(e=>(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"h-2 border-l border-muted-foreground"}),(0,s.jsx)("span",{children:e})]},e))}),(0,s.jsxs)("div",{className:"relative h-16 mb-6 bg-muted/20 rounded",style:{width:"".concat(100*f,"%")},children:[(0,s.jsx)("div",{className:"absolute top-0 bottom-0 bg-primary/20 rounded",style:{left:"".concat(N(a),"%"),width:"".concat(N(i)-N(a),"%")}}),l&&x&&(0,s.jsx)("div",{className:"absolute top-0 bottom-0 bg-green-500/30 rounded border-x-2 border-green-500",style:{left:"".concat(N(l),"%"),width:"".concat(N(x)-N(l),"%")}}),Object.entries(b).map(e=>{let[t,r]=e,l=Number.parseInt(t),n=l>=a&&l<=i;return(0,s.jsx)("div",{className:"absolute bottom-0 bg-primary/70 hover:bg-primary transition-colors cursor-pointer ".concat(n?"opacity-100":"opacity-40"),style:{left:"".concat(N(l),"%"),width:"".concat(Math.max(.5,1/324*100*(f>=2?3:f>=1.5?2:1)),"%"),height:"".concat(y(r),"px")},title:"".concat(t,": ").concat(r," images")},t)}),(0,s.jsx)("div",{className:"absolute top-0 bottom-0 w-0.5 bg-primary border-l-2 border-primary",style:{left:"".concat(N(a),"%")}}),(0,s.jsx)("div",{className:"absolute top-0 bottom-0 w-0.5 bg-primary border-l-2 border-primary",style:{left:"".concat(N(i),"%")}})]}),(0,s.jsx)("div",{className:"space-y-2",children:(0,s.jsx)(n,{value:[a,i],min:1700,max:2024,step:1,onValueChange:e=>{let[a,s]=e;t(a,s)},className:"w-full"})})]})]})}},1251:(e,t,a)=>{Promise.resolve().then(a.bind(a,8743))},3999:(e,t,a)=>{"use strict";a.d(t,{cn:()=>i});var s=a(2596),r=a(9688);function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}},7168:(e,t,a)=>{"use strict";a.d(t,{$:()=>o});var s=a(5155);a(2115);var r=a(9708),i=a(2085),l=a(3999);let n=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function o(e){let{className:t,variant:a,size:i,asChild:o=!1,...c}=e,d=o?r.DX:"button";return(0,s.jsx)(d,{"data-slot":"button",className:(0,l.cn)(n({variant:a,size:i,className:t})),...c})}},8145:(e,t,a)=>{"use strict";a.d(t,{E:()=>o});var s=a(5155);a(2115);var r=a(9708),i=a(2085),l=a(3999);let n=(0,i.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:a,asChild:i=!1,...o}=e,c=i?r.DX:"span";return(0,s.jsx)(c,{"data-slot":"badge",className:(0,l.cn)(n({variant:a}),t),...o})}},8482:(e,t,a)=>{"use strict";a.d(t,{BT:()=>n,Wu:()=>o,ZB:()=>l,Zp:()=>i});var s=a(5155);a(2115);var r=a(3999);function i(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-2 border py-2 shadow-sm",t),...a})}function l(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",t),...a})}function n(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",t),...a})}function o(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-2",t),...a})}},8743:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>L});var s=a(5155),r=a(2115),i=a(7168),l=a(6874),n=a.n(l),o=a(1168),c=a(6766),d=a(8482),u=a(2355),m=a(3052),x=a(2657),h=a(9074),f=a(5347),p=a(8136),v=a(4516),b=a(1284),g=a(7550),j=a(2138),N=a(8145),y=a(9304),w=a(3999);function k(e){let{delayDuration:t=0,...a}=e;return(0,s.jsx)(y.Kq,{"data-slot":"tooltip-provider",delayDuration:t,...a})}function _(e){let{...t}=e;return(0,s.jsx)(k,{children:(0,s.jsx)(y.bL,{"data-slot":"tooltip",...t})})}function z(e){let{...t}=e;return(0,s.jsx)(y.l9,{"data-slot":"tooltip-trigger",...t})}function C(e){let{className:t,sideOffset:a=0,children:r,...i}=e;return(0,s.jsx)(y.ZL,{children:(0,s.jsxs)(y.UC,{"data-slot":"tooltip-content",sideOffset:a,className:(0,w.cn)("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",t),...i,children:[r,(0,s.jsx)(y.i3,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}var A=a(7655);function E(e){let{className:t,children:a,...r}=e;return(0,s.jsxs)(A.bL,{"data-slot":"scroll-area",className:(0,w.cn)("relative",t),...r,children:[(0,s.jsx)(A.LM,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:a}),(0,s.jsx)(M,{}),(0,s.jsx)(A.OK,{})]})}function M(e){let{className:t,orientation:a="vertical",...r}=e;return(0,s.jsx)(A.VM,{"data-slot":"scroll-area-scrollbar",orientation:a,className:(0,w.cn)("flex touch-none p-px transition-colors select-none","vertical"===a&&"h-full w-2.5 border-l border-l-transparent","horizontal"===a&&"h-2.5 flex-col border-t border-t-transparent opacity-0",t),...r,children:(0,s.jsx)(A.lr,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}let S=e=>new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"});function $(e){let{startYear:t,endYear:a,clusterId:l,metadata:n}=e,[o,y]=(0,r.useState)(null),[w,A]=(0,r.useState)(!0),[M,$]=(0,r.useState)(null),[D,L]=(0,r.useState)(0),I=(0,r.useRef)(null),P=(0,r.useRef)(null);(0,r.useEffect)(()=>{(async()=>{try{A(!0);let e=await fetch("/api/data?type=clusters");if(!e.ok)throw Error("Failed to fetch clusters");let t=await e.json(),a=new Map(n.map(e=>[e.filepath,e])),s=Object.entries(t).map(e=>{let[t,s]=e,r=s.map(e=>{let t=a.get(e);return t?{id:e,src:t.prediction_section_iiif_url,alt:"".concat(t.name," - ").concat(t.pub_date),date:t.pub_date,publication:t.name,publisher:t.publisher,place_of_publication:t.place_of_publication,caption:"Published in ".concat(t.name," on ").concat(t.pub_date,".")}:null}).filter(e=>null!==e);return{id:t,title:"Cluster ".concat(t),description:"A cluster of visually similar images from historical newspapers.",similarImages:r,alternatePublications:[]}});y(s)}catch(e){e instanceof Error?$(e.message):$("An unknown error occurred")}finally{A(!1)}})()},[n]);let F=(0,r.useMemo)(()=>o?o.find(e=>e.id===l):null,[o,l]),O=(0,r.useMemo)(()=>F?F.similarImages.filter(e=>{let s=new Date(e.date).getFullYear();return s>=t&&s<=a}).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()):[],[F,t,a]);if((0,r.useEffect)(()=>{if(I.current&&O.length>0){let e=I.current.children[D];e&&e.scrollIntoView({behavior:"smooth",inline:"center",block:"nearest"})}},[D,O,F]),w)return(0,s.jsx)("div",{className:"text-center py-4",children:"Loading images..."});if(M)return(0,s.jsxs)("div",{className:"text-center py-4 text-red-500",children:["Error: ",M]});if(!o||!F)return(0,s.jsx)("div",{className:"text-center py-4",children:"No image cluster data available or cluster not found."});let Y=Math.min(Math.max(0,D),O.length-1),B=O[Y],T=e=>{L(e)};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:F.title}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)(N.E,{variant:"outline",className:"text-sm",children:[O.length," images (",t,"-",a,")"]})})]}),0===O.length&&(0,s.jsx)("div",{className:"p-6 text-center border rounded-lg bg-muted/50",children:(0,s.jsxs)("p",{className:"text-muted-foreground",children:["No images found in the selected time range (",t," - ",a,"). Try adjusting the timeline controls above."]})}),O.length>0&&(0,s.jsx)(d.Zp,{className:"overflow-hidden",children:(0,s.jsx)(d.Wu,{className:"p-6",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"font-medium",children:"Image Reproductions"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(i.$,{variant:"outline",size:"sm",onClick:()=>{D>0&&L(D-1)},disabled:0===Y,children:[(0,s.jsx)(u.A,{className:"h-4 w-4 mr-1"}),"Earlier"]}),(0,s.jsxs)(i.$,{variant:"outline",size:"sm",onClick:()=>{D<O.length-1&&L(D+1)},disabled:Y>=O.length-1,children:["Later",(0,s.jsx)(m.A,{className:"h-4 w-4 ml-1"})]})]})]}),(0,s.jsx)("div",{className:"flex flex-nowrap gap-4 overflow-x-auto overflow-y-hidden max-h-[250px] pb-4 hide-scrollbar",ref:I,children:O.map((e,t)=>{let a=t===Y;return(0,s.jsxs)("div",{className:"flex-none w-[150px] space-y-2",children:[(0,s.jsxs)("div",{className:"relative overflow-hidden cursor-pointer h-[150px] ".concat(a?"shadow-lg scale-105 transition-all":"group"),onClick:()=>T(t),children:[(0,s.jsx)(c.default,{src:e.src||"/placeholder.svg",alt:e.alt,width:500,height:300,className:"w-full h-full object-contain ".concat(a?"":"group-hover:scale-105 group-hover:shadow-md transition-transform duration-200")}),a&&(0,s.jsx)("div",{className:"absolute inset-0 bg-primary/10 flex items-center justify-center",children:(0,s.jsx)("div",{className:"bg-primary text-primary-foreground rounded-full p-1",children:(0,s.jsx)(x.A,{className:"h-4 w-4"})})})]}),(0,s.jsxs)("div",{className:"text-center space-y-1 mt-2",children:[(0,s.jsx)("p",{className:"text-xs font-medium",children:S(e.date)}),(0,s.jsx)("p",{className:"text-[0.65rem] text-muted-foreground truncate",children:e.publication})]})]},e.id)})}),(0,s.jsx)("div",{className:"relative h-2 bg-muted rounded-full",children:(0,s.jsx)("div",{className:"absolute top-0 h-full w-1 bg-primary rounded-full transition-all duration-300",style:{left:"".concat(Y/Math.max(1,O.length-1)*100,"%")}})})]}),B&&(0,s.jsx)("div",{className:"space-y-4 border-t pt-6",children:(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"relative overflow-hidden rounded-lg border flex items-center justify-center max-h-[400px]",children:(0,s.jsx)(c.default,{src:B.src||"/placeholder.svg",alt:B.alt,width:800,height:600,className:"w-full h-full object-contain"})})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium mb-2",children:"Image Details"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(h.A,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-sm",children:B.date})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(f.A,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-sm",children:B.publication})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(p.A,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-sm",children:B.publisher})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(v.A,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-sm",children:B.place_of_publication})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium mb-2",children:"Caption"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:B.caption})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium mb-2",children:"Position in Timeline"}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Image ",Y+1," of ",O.length," in selected range"]})]})]})]})}),F.alternatePublications.length>0&&(0,s.jsxs)("div",{className:"space-y-4 border-t pt-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"font-medium",children:"Similar Images in Other Publications"}),(0,s.jsx)(k,{children:(0,s.jsxs)(_,{children:[(0,s.jsx)(z,{asChild:!0,children:(0,s.jsx)(i.$,{variant:"ghost",size:"icon",children:(0,s.jsx)(b.A,{className:"h-4 w-4"})})}),(0,s.jsx)(C,{children:(0,s.jsx)("p",{className:"max-w-xs text-sm",children:"How different newspapers covered the same event on similar dates."})})]})})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(i.$,{variant:"outline",size:"icon",className:"absolute left-0 top-1/2 -translate-y-1/2 z-10 rounded-full bg-background/80 backdrop-blur-sm",onClick:()=>{P.current&&P.current.scrollBy({left:-200,behavior:"smooth"})},children:(0,s.jsx)(g.A,{className:"h-4 w-4"})}),(0,s.jsx)(E,{className:"pb-4 max-h-[200px]",children:(0,s.jsx)("div",{className:"flex space-x-4 px-8",ref:P,children:F.alternatePublications.map(e=>(0,s.jsxs)("div",{className:"flex-none w-[200px]",children:[(0,s.jsxs)("div",{className:"relative overflow-hidden rounded-lg border cursor-pointer hover:ring-2 hover:ring-primary/50 transition-all",children:[(0,s.jsx)(c.default,{src:e.src||"/placeholder.svg",alt:e.alt,width:200,height:150,className:"w-full h-auto object-cover"}),(0,s.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 p-1",children:[(0,s.jsx)("p",{className:"text-xs text-white truncate font-medium",children:e.publication}),(0,s.jsx)("p",{className:"text-xs text-white/80 truncate",children:e.date})]})]}),(0,s.jsx)("p",{className:"text-xs mt-1 line-clamp-2 text-muted-foreground",children:e.caption})]},e.id))})}),(0,s.jsx)(i.$,{variant:"outline",size:"icon",className:"absolute right-0 top-1/2 -translate-y-1/2 z-10 rounded-full bg-background/80 backdrop-blur-sm",onClick:()=>{P.current&&P.current.scrollBy({left:200,behavior:"smooth"})},children:(0,s.jsx)(j.A,{className:"h-4 w-4"})})]})]})]})})}),(0,s.jsxs)("div",{className:"p-4 border rounded-lg bg-muted/50",children:[(0,s.jsx)("h3",{className:"font-medium mb-2",children:"About This Cluster"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:F.description})]})]})}function D(e){let{clusterKey:t}=e,[a,l]=(0,r.useState)(null),[c,d]=(0,r.useState)(null),[u,m]=(0,r.useState)(null),[x,h]=(0,r.useState)(null),[f,p]=(0,r.useState)(!0),[v,b]=(0,r.useState)(null);if((0,r.useEffect)(()=>{(async()=>{try{p(!0);let[e,a]=await Promise.all([fetch("/api/data?type=clusters"),fetch("/api/data?type=metadata")]);if(!e.ok)throw Error("Failed to fetch clusters");if(!a.ok)throw Error("Failed to fetch metadata");let s=await e.json(),r=await a.json();l(s),d(r);let i=new Map(r.map(e=>[e.filepath,e])),n=s[t];if(n){let e=n.map(e=>{let t=i.get(e);if(t)return new Date(t.pub_date).getFullYear()}).filter(e=>void 0!==e&&e>0);e.length>0&&(m(Math.min(...e)),h(Math.max(...e)))}}catch(e){e instanceof Error?b(e.message):b("An unknown error occurred")}finally{p(!1)}})()},[t]),f)return(0,s.jsx)("div",{className:"container mx-auto py-8 text-center",children:"Loading..."});if(v)return(0,s.jsxs)("div",{className:"container mx-auto py-8 text-center text-red-500",children:["Error: ",v]});if(!a||!c||null===u||null===x)return(0,s.jsxs)("div",{className:"container mx-auto py-8 text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Cluster data not available."}),(0,s.jsx)(n(),{href:"/",children:(0,s.jsx)(i.$,{children:"Back to Cluster List"})})]});if(!a[t])return(0,s.jsxs)("div",{className:"container mx-auto py-8 text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Cluster not found"}),(0,s.jsx)(n(),{href:"/",children:(0,s.jsx)(i.$,{children:"Back to Cluster List"})})]});let g=Object.entries(a).map(e=>{let[t,a]=e,s=a[0]?c.find(e=>e.filepath===a[0]):void 0;return{id:t,imagePaths:a,firstImageMeta:s?{pub_date:s.pub_date}:void 0}});return(0,s.jsxs)("div",{className:"container mx-auto py-8",children:[(0,s.jsx)(o.K,{onDateRangeChange:(e,t)=>{m(e),h(t)},startYear:u,endYear:x,activeStartYear:u,activeEndYear:x,clusters:g}),(0,s.jsx)(n(),{href:"/",children:(0,s.jsx)(i.$,{className:"mb-4",children:"← Back to Gallery"})}),(0,s.jsx)($,{startYear:u,endYear:x,clusterId:t,metadata:c})]})}function L(e){let{params:t}=e,{id:a}=r.use(t);return a?(0,s.jsx)(D,{clusterKey:a}):(0,s.jsxs)("div",{className:"container mx-auto py-8 text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Cluster not found"}),(0,s.jsx)(n(),{href:"/",children:(0,s.jsx)(i.$,{children:"Back to Cluster List"})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[516,879,441,684,358],()=>t(1251)),_N_E=e.O()}]);